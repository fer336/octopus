<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>{{ voucher.type_name }} {{ voucher.letter }}</title>
	<style type="text/css">
		@page {
			size: A4;
			margin: 10mm;
		}
		* {
			box-sizing: border-box;
			margin: 0;
			padding: 0;
		}
		body {
			font-family: sans-serif;
			font-size: 11px;
			color: #000;
		}

		/* Contenedor principal */
		.invoice {
			width: 100%;
			border: 1px solid #000;
		}

		/* === ENCABEZADO === */
		.header-container {
			width: 100%;
			border-bottom: 1px solid #000;
			position: relative;
            min-height: 160px;
		}
        
        /* Línea vertical central absoluta */
        .header-vertical-line {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 1px;
            background-color: #000;
            transform: translateX(-50%);
            z-index: 1;
        }
        
        .header-table {
            width: 100%;
            border-collapse: collapse;
            position: relative;
            z-index: 2;
        }
        
        .header-col-left {
            width: 50%;
            vertical-align: top;
            padding: 15px 15px 10px 15px;
        }
        
        .header-col-right {
            width: 50%;
            vertical-align: top;
            padding: 15px 15px 10px 30px;
        }

		/* Letra del comprobante */
		.letter-box-container {
			position: absolute;
			top: 0;
			left: 50%;
			transform: translate(-50%, -50%);
            background-color: white;
            padding: 0 5px;
            z-index: 10;
		}
		.letter-box {
			border: 1px solid #000;
			width: 40px;
			height: 40px;
			line-height: 38px;
			font-size: 24px;
			font-weight: bold;
			text-align: center;
			background: #fff;
		}

		.business-name {
			font-size: 20px;
			font-weight: bold;
			margin-bottom: 8px;
		}
        
        .invoice-title {
			font-size: 20px;
			font-weight: bold;
			margin-bottom: 15px;
            text-align: center;
		}

		.info-line {
			margin: 3px 0;
			font-size: 11px;
            line-height: 1.3;
		}
		.info-line strong {
			font-weight: bold;
		}

        .logo-img {
            max-height: 50px;
            max-width: 180px;
            margin-bottom: 8px;
            display: block;
        }

		/* === CLIENTE === */
        .client-container {
            border-bottom: 1px solid #000;
            position: relative;
        }
        
        .client-table {
            width: 100%;
            border-collapse: collapse;
            position: relative;
            z-index: 2;
        }
        .client-col-left {
            width: 50%;
            vertical-align: top;
            padding: 10px 15px;
        }
        .client-col-right {
            width: 50%;
            vertical-align: top;
            padding: 10px 15px 10px 30px;
        }

		/* === TABLA DE ITEMS === */
		.items-table {
			width: 100%;
			border-collapse: collapse;
		}
		.items-table th {
			background: #c0c0c0;
			border: 1px solid #000;
            border-top: none;
            border-left: none;
            border-right: 1px solid #000;
			padding: 5px 4px;
			font-size: 10px;
			text-align: center;
			font-weight: bold;
		}
        .items-table th:last-child {
            border-right: none;
        }
		.items-table td {
			border-right: 1px solid #000;
            border-bottom: 1px solid #000;
			padding: 5px 4px;
			font-size: 10px;
			text-align: center;
		}
        .items-table td:last-child {
            border-right: none;
        }
		.items-table td:nth-child(3) {
			text-align: left;
		}

		/* === TOTALES === */
		.totals-section {
			width: 100%;
			border-top: 2px solid #000;
			border-bottom: 2px solid #000;
		}
		.totals-section td {
			padding: 6px 4px;
		}
		.total-label-inline {
			text-align: right;
			width: auto;
			font-weight: bold;
			font-size: 12px;
			white-space: nowrap;
            padding-left: 10px;
            padding-right: 4px;
		}
		.total-value-inline {
			text-align: left;
			width: auto;
			font-weight: bold;
			font-size: 12px;
            padding-right: 15px;
		}

		/* === FOOTER === */
		.footer {
			text-align: center;
			padding: 8px;
			font-size: 10px;
			color: #666;
		}
        .signature-section {
            margin-top: 30px;
            text-align: center;
            padding: 10px;
        }
	</style>
</head>
<body>

<div class="invoice">
    <!-- Header -->
    <div class="header-container">
        <!-- Línea vertical central absoluta -->
        <div class="header-vertical-line"></div>
        
        <div class="letter-box-container">
            <div class="letter-box">{{ voucher.letter }}</div>
        </div>
        
        <table class="header-table">
            <tr>
                <td class="header-col-left">
                    {% if business.logo_url %}
                    <img class="logo-img" src="{{ business.logo_url }}" alt="Logo">
                    {% endif %}
                    <div class="business-name">{{ business.name }}</div>
                    <div class="info-line"><strong>Domicilio Comercial:</strong> {{ business.address or 'Sin domicilio' }}</div>
                    <div class="info-line"><strong>Condición Frente al IVA:</strong> {{ business.tax_condition }}</div>
                    <br>
                    <div class="info-line"><strong>Período Facturado Desde:</strong> {{ voucher.date }}</div>
                    <div class="info-line"><strong>Hasta:</strong> {{ voucher.date }}</div>
                </td>
                <td class="header-col-right">
                    <div class="invoice-title">{{ voucher.type_name }}</div>
                    <div class="info-line"><strong>Punto de Venta:</strong> {{ voucher.sale_point }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>Comp. Nro:</strong> {{ voucher.comp_number }}</div>
                    <div class="info-line"><strong>Fecha de Emisión:</strong> {{ voucher.date }}</div>
                    <div class="info-line"><strong>Fecha de Vto. para el pago:</strong> {{ voucher.due_date or voucher.date }}</div>
                    <div class="info-line"><strong>CUIT:</strong> {{ business.cuit }}</div>
                    <div class="info-line"><strong>Ingresos Brutos:</strong> {{ business.iibb or '-' }}</div>
                    <div class="info-line"><strong>Fecha de Inicio de Actividades:</strong> {{ business.start_date or '-' }}</div>
                </td>
            </tr>
        </table>
    </div>

    <!-- Client -->
    <div class="client-container">
        <table class="client-table">
            <tr>
                <td class="client-col-left">
                    <div class="info-line"><strong>Apellido y Nombre / Razón social:</strong> {{ client.name }}</div>
                    <div class="info-line"><strong>Domicilio:</strong> {{ client.address or 'Sin domicilio' }}</div>
                </td>
                <td class="client-col-right">
                    <div class="info-line"><strong>CUIL/CUIT:</strong> {{ client.document_number or '-' }}</div>
                    <div class="info-line"><strong>Condición Frente al IVA:</strong> {{ client.tax_condition or 'Consumidor Final' }}</div>
                    <div class="info-line"><strong>Condición de venta:</strong> {{ voucher.payment_method or 'Efectivo' }}</div>
                </td>
            </tr>
        </table>
    </div>

    <!-- Items -->
    <table class="items-table">
        <thead>
            <tr>
                <th style="width: 10%">Cantidad</th>
                <th style="width: 15%">Código</th>
                <th style="width: 45%">Producto / Servicio</th>
                <th style="width: 10%">Precio Unit.</th>
                <th style="width: 10%">% Bonif.</th>
                <th style="width: 10%">Subtotal</th>
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
            <tr>
                <td>{{ item.quantity }}</td>
                <td>{{ item.code or '-' }}</td>
                <td>{{ item.description }}</td>
                <td>{{ item.unit_price }}</td>
                <td>{{ item.discount or '0,00' }}</td>
                <td>{{ item.subtotal }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Totals -->
    {% if voucher.show_prices %}
    <table class="totals-section" cellspacing="0" cellpadding="0" style="width: 100%; table-layout: auto;">
        <tr>
            <td class="total-label-inline"><strong>Subtotal: $</strong></td>
            <td class="total-value-inline">{{ totals.subtotal }}</td>
            
            <td class="total-label-inline"><strong>Bonificación: $</strong></td>
            <td class="total-value-inline">{{ totals.discount }}</td>
            
            <td class="total-label-inline"><strong>IVA: $</strong></td>
            <td class="total-value-inline">{{ totals.iva }}</td>
            
            <td class="total-label-inline"><strong>Importe total: $</strong></td>
            <td class="total-value-inline">{{ totals.total }}</td>
        </tr>
    </table>
    {% endif %}

    <!-- Footer -->
    <div class="footer">
        Sistema creado por <strong>Qeva AI</strong> · Contacto: +54 9 225 459-6618
    </div>
    
    {% if voucher.letter == 'R' %}
    <div class="signature-section">
        <p>Recibí conforme: ....................................................................</p>
    </div>
    {% endif %}

</div>

</body>
</html>